# Detailed Classification of Malware Types

> Reference guide for common malware categories, behaviors, and detection considerations. Last updated: November 3, 2025.

## Automated Classification Utility

Use `classify_malware.py` to score IR reports with the heuristic rules described in this document.

```bash
# Classify a single IR report
python3 classify_malware.py --ir output/ir_results/sample_ir.json

# Scan the default IR output directory and save JSON results
python3 classify_malware.py --output reports/malware_classification.json

# Show full JSON output in the console
python3 classify_malware.py --format json --top 5
```

The script inspects behavior flags, API usage, and opcode hints to assign one or more categories. Match confidences are capped at 1.00 and accompanied by evidence tokens (e.g., `behavior:uses_network`, `api_any:CREATEPROCESSW`). Samples with no rule matches are labeled **Uncategorized**.

## 1. High-Level Taxonomy

Malware can be grouped along multiple dimensions. Understanding these axes helps analysts classify new samples more accurately.

| Dimension             | Description                                     | Representative Types                                             |
| --------------------- | ----------------------------------------------- | ---------------------------------------------------------------- |
| **Propagation**       | How the malware spreads or gains initial access | Viruses, worms, trojans, droppers, supply-chain attacks          |
| **Execution Target**  | The platform or environment the malware targets | Windows PE, Linux ELF, macOS Mach-O, Android APK, firmware, IoT  |
| **Payload Intent**    | The ultimate malicious objective                | Ransomware, spyware, botnet agent, crypto-miner, data wiper      |
| **Stealth Strategy**  | Techniques used to avoid detection              | Fileless malware, rootkits, polymorphic/metamorphic malware      |
| **Command & Control** | How the malware communicates with operators     | Centralized C2, peer-to-peer, dead-drop resolvers, DNS tunneling |

Subsections below highlight the most common categories and their defining attributes.

## 2. Propagation-Based Categories

### 2.1 Viruses

- **Propagation**: Attach to legitimate files or boot sectors; require user execution.
- **Key Traits**: Recursive infection, destructive or parasitic payloads, often modify host executables.
- **Notable Techniques**: Entry-point obfuscation, polymorphic engines, stealth infection counters.
- **Examples**: CIH (Chernobyl), Sality, Virut.

### 2.2 Worms

- **Propagation**: Self-replicating across networks without user intervention.
- **Key Traits**: Exploit remote vulnerabilities, brute-force weak credentials, rapid lateral movement.
- **Impact**: Network congestion, mass infection, potential payload delivery (e.g., ransomware).
- **Examples**: Slammer, Conficker, WannaCry.

### 2.3 Trojans

- **Propagation**: Distributed as legitimate-looking software; no autonomous replication.
- **Key Traits**: Social engineering, hidden malicious functionality, often part of multi-stage attacks.
- **Subtypes**: Remote Access Trojans (RATs), banking trojans, downloaders/droppers.
- **Examples**: Zeus, Emotet (initially a banking trojan, later evolved), TrickBot.

### 2.4 Droppers and Downloaders

- **Propagation**: Lightweight stagers that deliver additional payloads.
- **Key Traits**: Obfuscated, small footprint, often use encrypted payload containers or steganography.
- **Lifecycle**: Initial execution -> payload retrieval (HTTP/S, FTP, P2P) -> persistence setup.
- **Examples**: SmokeLoader, GootLoader.

### 2.5 Supply-Chain & Watering-Hole Attacks

- **Propagation**: Compromise trusted software updates or websites.
- **Key Traits**: Signed with legitimate certificates, embedded in installers or patch bundles.
- **Examples**: SolarWinds (SUNBURST), CCleaner compromise, NotPetya (MeDoc software).

## 3. Payload-Based Categories

### 3.1 Ransomware

- **Objective**: Encrypt or exfiltrate data, demand payment for recovery.
- **Common Features**: Hybrid encryption, key exchange with C2, data exfiltration for double extortion.
- **Variants**: Locker ransomware (locks screen), crypto-ransomware (encrypts files), wiper disguised as ransomware (e.g., NotPetya).
- **Examples**: LockBit, Conti, Ryuk, WannaCry.

### 3.2 Spyware & Info-Stealers

- **Objective**: Steal credentials, financial data, surveillance.
- **Techniques**: Keylogging, form grabbing, clipboard hijacking, screen capture, browser data exfiltration.
- **Examples**: Agent Tesla, RedLine Stealer, FinFisher.

### 3.3 Backdoors & RATs

- **Objective**: Provide persistent remote control of the victim system.
- **Features**: Command execution, file transfer, credential harvesting, camera/microphone control.
- **Persistence**: Service installation, registry run keys, scheduled tasks, WMI event subscriptions.
- **Examples**: Gh0st RAT, Cobalt Strike Beacon (dual-use), PlugX.

### 3.4 Botnets

- **Objective**: Create a network of compromised systems for coordinated tasks.
- **Tasks**: DDoS attacks, spam campaigns, click fraud, credential stuffing, proxy networks.
- **C2 Patterns**: IRC-based, HTTP-based, P2P overlays, domain generation algorithms (DGAs).
- **Examples**: Mirai, Emotet (as botnet), Cutwail.

### 3.5 Financial Malware

- **Objective**: Steal money via banking systems or cryptocurrency.
- **Subtypes**:
  - Point-of-Sale (POS) malware: RAM scraping, magstripe interception (e.g., BlackPOS).
  - Banking trojans: Webinjects, man-in-the-browser (e.g., Zeus, Dridex).
  - Crypto miners: Hijack CPU/GPU resources for cryptocurrency mining (e.g., XMRig-based campaigns).

### 3.6 Wipers

- **Objective**: Destroy data or render systems unusable.
- **Indicators**: Overwrite MBR, encrypt with no recovery key, targeted deletion of logs and backups.
- **Examples**: Shamoon, NotPetya, Olympic Destroyer.

## 4. Stealth & Evasion Techniques

### 4.1 Fileless Malware

- **Description**: Operates in memory, leveraging legitimate tools (LOLbins) like PowerShell, WMI.
- **Persistence**: Registry keys, scheduled tasks, WMI event consumers.
- **Detection**: Memory forensics, behavioral monitoring, script block logging.

### 4.2 Polymorphic & Metamorphic Malware

- **Polymorphic**: Constantly encrypts/decrypts payload with varying keys; decryptor stub mutates.
- **Metamorphic**: Rewrites its own code on each infection, altering instruction sequences while preserving functionality.
- **Purpose**: Evade signature-based detection.

### 4.3 Rootkits

- **Scope**: Modify OS components (kernel, drivers) to hide artifacts and maintain control.
- **Types**: User-mode, kernel-mode, bootkits, firmware-level.
- **Detection**: Integrity checking (e.g., kernel module enumeration), hypervisor-based monitoring, hardware attestation.

### 4.4 Obfuscation & Packing

- **Techniques**: Packers (UPX, custom), code virtualization, junk instructions, API hashing, string encryption.
- **Goal**: Impede reverse engineering, bypass static detection.

## 5. Target Platform Examples

| Platform / Ecosystem | Common Malware Families            | Notes                                                         |
| -------------------- | ---------------------------------- | ------------------------------------------------------------- |
| Windows              | Emotet, TrickBot, Dridex, Ryuk     | Dominant target due to market share; rich LOLbin ecosystem.   |
| Linux/Unix           | Mirai variants, Gafgyt, Symbiote   | Focus on servers, IoT devices; often used for botnets/mining. |
| macOS                | Silver Sparrow, Shlayer, XLoader   | Increasing due to rising popularity; signed payload abuse.    |
| Android              | FluBot, Joker, EventBot            | Malware via sideloaded APKs, SMS phishing, malicious SDKs.    |
| Firmware/IoT         | VPNFilter, Modular routers malware | Persistence across reboots; limited visibility for defenders. |

## 6. Multi-Stage & Hybrid Threats

Modern campaigns often blend multiple malware types:

- **Loader + RAT + Ransomware**: Initial loader (phishing) -> RAT for reconnaissance -> deploy ransomware payload.
- **Botnet-as-a-Service**: Botnets deliver additional payloads (ransomware, stealers) on demand.
- **Malvertising Chains**: Exploit kits (e.g., RIG) deliver droppers, followed by info-stealers or ransomware.
- **APT Campaigns**: Custom backdoors, living-off-the-land techniques, zero-day exploits, tailored payloads.

## 7. Detection & Analysis Considerations

### 7.1 Indicators of Compromise (IOCs)

- File hashes (MD5/SHA256) for known payloads.
- Network indicators: C2 domains/IPs, domains generated by DGAs, TLS certificate fingerprints.
- Behavioral indicators: Registry changes, scheduled tasks, service creation, DLL injection patterns.

### 7.2 Analysis Workflow Suggestions

1. **Static Analysis**: Hashing, PE/ELF metadata, string extraction, import table review.
2. **Dynamic Analysis**: Sandbox execution, API call tracing, network capture.
3. **Memory Forensics**: Volatility, Rekall for detecting fileless activity.
4. **IR Correlation**: Cross-reference behaviors with known families using CTI feeds.
5. **ML Classification**: Feature extraction (API frequency, CFG metrics) feeding ML models (e.g., RandomForest).

### 7.3 Prevention & Mitigation

- Regular patching and vulnerability management.
- Principle of least privilege, network segmentation.
- Endpoint detection and response (EDR) with behavioral analytics.
- Application whitelisting and script control policies.
- Backup and disaster recovery plans resistant to ransomware (offline/immutable storage).

## 8. Reference Mapping for MEEF

When producing IR with MEEF:

- **API Counts** help flag spyware (keylogging APIs), ransomware (cryptographic APIs), network trojans (WinInet/WinHTTP).
- **CFG Complexity** may indicate obfuscation or packed code.
- **Opcode Distributions** highlight low-level behaviors (e.g., high `INT 2E` usage in rootkits).
- **Behavior Flags** (file, registry, network, injection) correlate with categories in Sections 2â€“4.

Consider enriching catalog entries with tags from this classification to improve triage and reporting.

---

## 9. Further Reading

- MITRE ATT&CK: https://attack.mitre.org
- Malware Analysis and Detection Engineering (Practical Malware Analysis, Practical Reverse Engineering)
- Verizon DBIR, Mandiant M-Trends, Microsoft Security Intelligence Reports
- CERT/CC vulnerability notes, US-CERT alerts

---

**Maintainer Note**: Keep this document updated as new malware trends emerge (e.g., AI-powered payloads, cross-platform toolkits, supply-chain poisonings). Contributions welcome.
